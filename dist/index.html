<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="./css/style.css">
  <title>PadManiacs</title>

  <script src="./lib/phaser.min.js"></script>
  <script src="./lib/eruda.js"></script>
  <script src="./js/game.js"></script>
</head>

<body>
  <div id="game"></div>
  
  <!-- Controller -->
  <div id="controller">
    <div id="controller_dpad">
      <div id="controller_left"></div>
      <div id="controller_right"></div>
      <div id="controller_up"></div>
      <div id="controller_down"></div>
    </div>
    <div id="controller_rhythm_pad">
      <div id="controller_rhythm_left" class="capsuleBtn rhythm"></div>
      <div id="controller_rhythm_down" class="capsuleBtn rhythm"></div>
      <div id="controller_rhythm_up" class="capsuleBtn rhythm"></div>
      <div id="controller_rhythm_right" class="capsuleBtn rhythm"></div>
    </div>
    <div id="controller_select" class="capsuleBtn">Select</div>
    <div id="controller_start" class="capsuleBtn">Start</div>
    <div id="controller_b" class="roundBtn">B</div>
    <div id="controller_a" class="roundBtn">A</div>
  </div>
  
  <!-- Debug Panel -->
  <div id="debug"></div>

  <script>
    // Auto-enable debug mode if URL has debug parameter
    if (location.search.includes('debug')) {
      window.DEBUG = true;
    }
    
    // Debug initialization
    if (typeof window.eruda !== 'undefined' && (window.DEBUG || location.search.includes('debug'))) {
      eruda.init({
        tool: ['console', 'elements', 'resources', 'snippets']
      });
      
      const snippets = eruda.get('snippets');
      snippets.clear();
      
      // Debug utilities
      snippets.add("Start Recording", () => {
        if (window.game && game.recorder) {
          game.recorder.start();
        } else {
          console.warn('Game not initialized yet');
        }
      }, "Start recording the game");
      
      snippets.add("Stop Recording", () => {
        if (window.game && game.recorder) {
          game.recorder.stop();
        }
      }, "Stop recording and save video");
      
      snippets.add("Record Next Game", () => {
        window.recordNextGame = true;
        console.log('Recording will start on next game');
      }, "Start recording next song, stop when it ends");
      
      snippets.add("Take Screenshot", () => {
        if (window.game && game.recorder) {
          game.recorder.screenshot();
        }
      }, "Take a screenshot");
      
      snippets.add("Auto Screenshots", () => {
        const screenshot = () => {
          if (window.game && game.recorder) {
            game.recorder.screenshot();
            setTimeout(screenshot, Phaser.Math.between(5000, 20000));
          }
        };
        screenshot();
      }, "Take screenshots randomly every 5-20 seconds");
      
      snippets.add("Add FPS Counter", () => {
        if (window.game) {
          addFpsText();
        }
      }, "Displays performance information");
      
      snippets.add("Reload Game", () => {
        location.reload();
      }, "Reload the game");
      
      snippets.add("Destroy Eruda", () => {
        eruda.destroy();
      }, "Remove debug panel");
      
      console.log('PadManiacs Debug Mode Active');
      console.log('Platform:', CURRENT_ENVIRONMENT);
    }
  </script>
</body>

</html>